function cIm = Ci2cIm(Ci)% CI2CIM % Ci must be Z-transformed% Transforms a Ci classification image (hrCi)%	into a uint8 color image (cIm). The color image can then be saved in % 	your favorite image format without loss of information (e.g., TIF). % 	E.g.,	Ci = randn(256,256);% 			cIm = Ci2cIm(Ci);%			IMWRITE(cIm,'anImage.tif','tif') % See also DEMOSTAT4CI, CIM2HRCI% % The Stat4Ci toolbox is free (http://mapageweb.umontreal.ca/gosselif/stat4ci.html); if you use % it in your research, please, cite us:%	Chauvin, A., Worsley, K. J., Schyns, P. G., Arguin, M. & Gosselin, F. (2004).  A sensitive %	statistical test for smooth classification images.% % Alan Chauvin & Frédéric Gosselin (frederic.gosselin@umontreal.ca), 20/08/2004kk = (256^3 - 1); t1 = min(Ci(:)); t2 = max(Ci(:));aa = kk / (t2-t1); bb = t1 * kk / (t2-t1);hrCi = aa * Ci - bb;hrCi(1,1) = aa; hrCi(end,end) = -bb;tIm(:,:,3) = mod(hrCi, 256);tIm(:,:,2) = mod(hrCi - squeeze(tIm(:,:,3)), 256^2);tIm(:,:,1) = mod(hrCi - squeeze(tIm(:,:,3)) - squeeze(tIm(:,:,2)), 256^3);tIm(:,:,2) = tIm(:,:,2) / 256;tIm(:,:,1) = tIm(:,:,1) / 256^2;cIm = uint8(tIm);